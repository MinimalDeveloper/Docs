<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2543ff947a193d7f33b1.css">@import url(https://fonts.googleapis.com/css?family=Inconsolata&display=swap);@import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap);</style><meta name="generator" content="Gatsby 2.19.45"/><title data-rh="true">NodeJS + AWS | Matt Mayfield</title><meta data-rh="true" name="description" content="Documentation site for all projects"/><meta data-rh="true" property="og:title" content="NodeJS + AWS"/><meta data-rh="true" property="og:description" content="Documentation site for all projects"/><meta data-rh="true" property="og:type" content="website"/><meta data-rh="true" name="twitter:card" content="summary"/><meta data-rh="true" name="twitter:title" content="NodeJS + AWS"/><meta data-rh="true" name="twitter:description" content="Documentation site for all projects"/><title data-react-helmet="true"></title><link as="script" rel="preload" href="/webpack-runtime-22f56f90e70b3c67d9aa.js"/><link as="script" rel="preload" href="/styles-e213a0d857960fd55403.js"/><link as="script" rel="preload" href="/app-7c842360d978e7d2baa8.js"/><link as="script" rel="preload" href="/commons-99e66c7da493e5e14858.js"/><link as="script" rel="preload" href="/component---docs-awsnode-mdx-4e4b372ff7210d200ba0.js"/><link as="fetch" rel="preload" href="/page-data/docs/aws-ec2-node-red/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="1ouyflx">.css-1ouyflx{font-family:'Source Sans Pro',sans-serif;font-size:20px;font-weight:400;line-height:1.5;color:var(--theme-ui-colors-text,#2D3747);background-color:var(--theme-ui-colors-background,#FFFFFF);}</style><div class="css-1ouyflx"><style data-emotion-css="jrjj6h">.css-jrjj6h > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="1ubpee3">.css-1ubpee3{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1ubpee3 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="hbri28">.css-hbri28{box-sizing:border-box;min-width:0;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-hbri28 > div{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><div data-testid="layout" class="css-hbri28"><style data-emotion-css="1xva7m0">body{margin:0;padding:0;}.icon-link{display:none;}.with-overlay{overflow:hidden;}</style><style data-emotion-css="zf0iqh">.css-zf0iqh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><style data-emotion-css="1tjxv7i">.css-1tjxv7i{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><style data-emotion-css="238csb">.css-238csb{box-sizing:border-box;min-width:0;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}</style><main class="css-238csb"><style data-emotion-css="18wmtq">.css-18wmtq{background-color:var(--theme-ui-colors-header-bg,#F5F6F7);position:relative;z-index:1;border-bottom:1px solid var(--theme-ui-colors-border,#CED4DE);}</style><div data-testid="header" class="css-18wmtq"><style data-emotion-css="zankq9">.css-zankq9{display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-zankq9{display:block;}}</style><style data-emotion-css="1s0wdqz">.css-1s0wdqz{box-sizing:border-box;min-width:0;display:none;position:absolute;top:calc(100% + 15px);left:30px;}@media screen and (max-width:57.5em){.css-1s0wdqz{display:block;}}</style><div class="css-1s0wdqz"><style data-emotion-css="4019lz">.css-4019lz{padding:0;outline:none;background:transparent;border:none;color:var(--theme-ui-colors-header-text,#2D3747);opacity:0.5;cursor:pointer;}.css-4019lz:hover{cursor:pointer;}</style><button class="css-4019lz"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div><style data-emotion-css="z6jak6">.css-z6jak6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding-left:32px;padding-right:32px;position:relative;height:80px;}</style><div class="css-z6jak6"><style data-emotion-css="xenp3v">.css-xenp3v{-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="1abzlu">.css-1abzlu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><style data-emotion-css="ug0363">.css-ug0363{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-letter-spacing:-0.02em;-moz-letter-spacing:-0.02em;-ms-letter-spacing:-0.02em;letter-spacing:-0.02em;font-weight:600;font-size:24px;}</style><div data-testid="logo" class="css-ug0363"><style data-emotion-css="gyijir">.css-gyijir{font-weight:600;color:var(--theme-ui-colors-header-text,#2D3747);-webkit-text-decoration:none;text-decoration:none;}.css-gyijir:hover{color:var(--theme-ui-colors-primary,#0B5FFF);}</style><a class="css-gyijir" href="/">Matt Mayfield</a></div><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><style data-emotion-css="80zs6q">.css-80zs6q{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-80zs6q"><style data-emotion-css="12z0wuy">.css-12z0wuy{margin-right:8px;}</style><style data-emotion-css="q6cf68">.css-q6cf68{box-sizing:border-box;min-width:0;margin-right:8px;}</style><div class="css-q6cf68"><style data-emotion-css="1is33jg">.css-1is33jg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;outline:none;padding:12px;border:none;border-radius:9999px;background-color:var(--theme-ui-colors-header-button-bg,#0B5FFF);color:var(--theme-ui-colors-header-button-color,#FFFFFF);font-size:12px;font-weight:600;cursor:pointer;}</style><a href="https://github.com/MinimalDeveloper/Docs" target="_blank" rel="noopener noreferrer" class="css-1is33jg"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></div><button class="css-1is33jg"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></button></div><style data-emotion-css="1gncnz1">.css-1gncnz1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;bottom:-40px;right:30px;background-color:transparent;color:var(--theme-ui-colors-muted,#67788a);font-size:14px;-webkit-text-decoration:none;text-decoration:none;border-radius:4px;}</style><a href="https://github.com/MinimalDeveloper/Docs/edit/master/docs/awsnode.mdx" target="_blank" rel="noopener noreferrer" class="css-1gncnz1"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg><style data-emotion-css="1iuj5ih">.css-1iuj5ih{padding-left:8px;}</style><style data-emotion-css="1x2jprh">.css-1x2jprh{box-sizing:border-box;min-width:0;padding-left:8px;}</style><div class="css-1x2jprh">Edit page</div></a></div></div><style data-emotion-css="w2cmj1">.css-w2cmj1{padding-top:0;padding-bottom:0;-webkit-flex:1;-ms-flex:1;flex:1;display:grid;grid-template-columns:250px 1fr;min-height:100vh;}@media screen and (max-width:57.5em){.css-w2cmj1{display:block;}}</style><div class="css-w2cmj1"><style data-emotion-css="1tn7q1x">.css-1tn7q1x{z-index:999;position:fixed;top:81px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><style data-emotion-css="h4snl3">.css-h4snl3{box-sizing:border-box;min-width:0;z-index:999;position:fixed;top:81px;right:0;bottom:0;left:0;background:rgba(0,0,0,0.6);-webkit-transition:all .2s ease-out;transition:all .2s ease-out;visibility:hidden;opacity:0;}</style><div class="css-h4snl3"></div><style data-emotion-css="1ethd5x">.css-1ethd5x{padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#CED4DE);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#FFFFFF);}@media screen and (max-width:57.5em){.css-1ethd5x{z-index:9999;display:block;position:fixed;top:81px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><style data-emotion-css="1li9yso">.css-1li9yso{box-sizing:border-box;min-width:0;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:-webkit-sticky;position:sticky;top:0;z-index:1;min-width:0;max-height:100vh;border-right:1px solid var(--theme-ui-colors-border,#CED4DE);overflow:auto;-webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-sidebar-bg,#FFFFFF);}@media screen and (max-width:57.5em){.css-1li9yso{z-index:9999;display:block;position:fixed;top:81px;left:0;bottom:0;width:256px;padding-left:32px;padding-right:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);-webkit-transition:-webkit-transform .2s ease-out;-webkit-transition:transform .2s ease-out;transition:transform .2s ease-out;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}}</style><div data-testid="sidebar" class="css-1li9yso"><style data-emotion-css="lcm9hh">.css-lcm9hh{margin-bottom:16px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div data-testid="nav-search" class="css-lcm9hh"><style data-emotion-css="1mo6uhh">.css-1mo6uhh{color:var(--theme-ui-colors-border,#CED4DE);margin-right:8px;}</style><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1mo6uhh"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><style data-emotion-css="1bbueiu">.css-1bbueiu{outline:none;background:none;border:none;color:var(--theme-ui-colors-text,#2D3747);font-size:14px;}</style><input placeholder="Type to search..." value="" class="css-1bbueiu"/></div><style data-emotion-css="1ebprri">.css-1ebprri{margin-top:16px;margin-bottom:16px;}</style><div data-testid="nav-group" class="css-1ebprri"><style data-emotion-css="1c8kbwa">.css-1c8kbwa{margin-bottom:4px;font-size:16px;font-weight:500;color:var(--theme-ui-colors-sidebar-navGroup,#2D3747);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-1c8kbwa">Docs<style data-emotion-css="1scp5x8">.css-1scp5x8{margin-left:4px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-align-self:baseline;-ms-flex-item-align:baseline;align-self:baseline;-webkit-transform:rotateX(180deg);-ms-transform:rotateX(180deg);transform:rotateX(180deg);-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-transition:-webkit-transform .3s ease-in-out;-webkit-transition:transform .3s ease-in-out;transition:transform .3s ease-in-out;}</style><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="css-1scp5x8"><polyline points="6 9 12 15 18 9"></polyline></svg></div><style data-emotion-css="1isemmb">.css-1isemmb{margin-left:8px;}</style><div data-testid="nav-group-links" class="css-1isemmb"><style data-emotion-css="1rqvyud">.css-1rqvyud{margin-top:8px;margin-bottom:8px;display:block;color:var(--theme-ui-colors-sidebar-navGroup,#2D3747);-webkit-text-decoration:none;text-decoration:none;font-size:16px;}.css-1rqvyud.active{color:var(--theme-ui-colors-sidebar-navLinkActive,#0B5FFF);}</style><a class="css-1rqvyud" href="/docs/">Getting Started</a><a aria-current="page" class="css-1rqvyud active" href="/docs/aws-ec2-node-red/">NodeJS + AWS</a><style data-emotion-css="1ooej63">.css-1ooej63{margin-top:8px;margin-bottom:8px;display:block;color:var(--theme-ui-colors-sidebar-tocLink,#67788a);-webkit-text-decoration:none;text-decoration:none;font-size:14px;margin-left:16px;position:relative;}.css-1ooej63.active{color:var(--theme-ui-colors-sidebar-tocLinkActive,#1D2330);}.css-1ooej63.active::before{content:"";position:absolute;display:block;top:2px;left:-8px;height:1rem;background-color:var(--theme-ui-colors-primary,#0B5FFF);-webkit-transition:width 200ms ease 0s;transition:width 200ms ease 0s;width:2px;border-radius:1px;}</style><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#start-an-aws-server">Start an AWS server</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#ssh-into-the-server">SSH into the server</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#install-nodejs">Install Node.js</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#create-a-public-http-endpoint-that-responds-with-a-static-message">Create a public HTTP endpoint that responds with a static message</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#serve-http-traffic-on-the-standard-port-80">Serve HTTP traffic on the standard port, 80</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#keep-the-nodejs-process-running">Keep the Node.js process running</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#deploy-code-into-the-server">Deploy code into the server</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#serve-some-html">Serve some HTML</a><a class=" css-1ooej63" href="/docs/aws-ec2-node-red/#install-node-red-on-aws-ec2-instance">Install Node-Red on AWS EC2 instance</a></div></div><a class="css-1rqvyud" href="/blog-hello-world-index">Hello World</a><a class="css-1rqvyud" href="/blog-my-second-post-index">My Second Post!</a><a class="css-1rqvyud" href="/blog-hi-folks-index">New Beginnings</a><a class="css-1rqvyud" href="/readme">Readme</a></div><style data-emotion-css="1w3d2mg">.css-1w3d2mg{background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-1w3d2mg{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="kjtkh5">.css-kjtkh5{width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-kjtkh5{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><style data-emotion-css="1307vk3">.css-1307vk3{box-sizing:border-box;min-width:0;width:100%;min-width:0;max-width:1280px;margin-left:auto;margin-right:auto;padding:32px;background-color:var(--theme-ui-colors-background,#FFFFFF);position:relative;max-width:1280px;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;padding:32px;}@media screen and (max-width:57.5em){.css-1307vk3{padding-top:48px;padding-bottom:32px;padding-left:32px;padding-right:32px;}}</style><div data-testid="main-container" class="css-1307vk3"><style data-emotion-css="1vci3bl">.css-1vci3bl{padding:0;margin:0;margin-bottom:16px;font-size:48px;font-family:'Source Sans Pro',sans-serif;line-height:1.125;font-weight:700;}</style><h1 id="aws-ec2-nodejs-node-red" class="css-1vci3bl">AWS-EC2-Node.js-Node-Red</h1><style data-emotion-css="1ftn47p">.css-1ftn47p{padding:0;margin:0;margin-bottom:16px;}</style><p class="css-1ftn47p">Creating and managing a Node.js server on AWS</p><h3 id="what-will-be-discussed-how-to"><style data-emotion-css="1r0pe6c">.css-1r0pe6c{color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-1r0pe6c:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="#what-will-be-discussed-how-to" class="css-1r0pe6c">What will be discussed? How to:</a></h3><style data-emotion-css="cvh4i0">.css-cvh4i0{padding:0;margin:0;margin-bottom:16px;list-style-position:outside;list-style-image:none;margin-left:16px;}</style><ul class="css-cvh4i0"><style data-emotion-css="q43a5f">.css-q43a5f{margin-bottom:4px;padding-left:0;}.css-q43a5f ol{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f ul{margin-top:8px;margin-bottom:8px;margin-left:16px;}.css-q43a5f p{margin-bottom:8px;}</style><li class="css-q43a5f">Start an AWS server</li><li class="css-q43a5f">SSH into the server</li><li class="css-q43a5f">Install Node.js</li><li class="css-q43a5f">Create a public HTTP endpoint that responds with a static message</li><li class="css-q43a5f">Serve HTTP traffic on the standard port, 80</li><li class="css-q43a5f">Keep the Node.js process running</li><li class="css-q43a5f">Deploy code into the server</li><li class="css-q43a5f">Serve some HTML</li><li class="css-q43a5f">Install Node-Red on AWS EC2 instance</li></ul><h2 id="start-an-aws-server"><a href="#start-an-aws-server" class="css-1r0pe6c">Start an AWS server</a></h2><ol class="css-cvh4i0"><li class="css-q43a5f"><p class="css-1ftn47p">Log in to the AWS EC2 console</p></li><li class="css-q43a5f"><p class="css-1ftn47p">Click ‘Launch Instance’</p></li><li class="css-q43a5f"><p class="css-1ftn47p">In the list of Quick Start AMIs, select Ubuntu Server</p></li><li class="css-q43a5f"><p class="css-1ftn47p">Select the Instance Type - t2.micro is a good starting point</p></li><li class="css-q43a5f"><p class="css-1ftn47p">Click Next: Configure Instance, click Next: Add Storage, click Next: Add Tags</p></li><li class="css-q43a5f"><p class="css-1ftn47p">Click Next: Configure Security Group.</p></li></ol><ul class="css-cvh4i0"><li class="css-q43a5f">A security group is a config for your server, telling it which ports it should expose to which IP addresses for certain types of traffic.</li><li class="css-q43a5f">Name the group something meaningful</li><li class="css-q43a5f">To run our app we are going to need SSH access, which by default is on port 22 and uses the TCP protocol. Amazon adds this in for us by default.</li><li class="css-q43a5f">Since we would like to also serve an app we need to expose a HTTP port publicly, by default this is port 80</li></ul><ol start="7" class="css-cvh4i0"><li class="css-q43a5f"><p class="css-1ftn47p">Click Add Rule and select the type as HTTP, the default settings for this will use TCP as the protocol and expose port 80 to all IPs.</p></li><li class="css-q43a5f"><p class="css-1ftn47p">To launch the instance, click Review and Launch, then click Launch.</p></li></ol><ul class="css-cvh4i0"><li class="css-q43a5f">You will be prompted to setup an SSH key which will give you access to the instance.</li></ul><ol start="9" class="css-cvh4i0"><li class="css-q43a5f"><p class="css-1ftn47p">Choose create a new key pair, and name the key something meaningful.</p></li><li class="css-q43a5f"><p class="css-1ftn47p">Click Download Key Pair.</p></li></ol><ul class="css-cvh4i0"><li class="css-q43a5f">This should download a .pem file which can be used to SSH into the server.</li><li class="css-q43a5f">Keep this file safe because anyone can connect to your server using it, if you lose the file you will need to generate a new one.</li></ul><ol start="11" class="css-cvh4i0"><li class="css-q43a5f">Click Launch Instance. Click View Instances.</li></ol><h2 id="ssh-into-the-server"><a href="#ssh-into-the-server" class="css-1r0pe6c">SSH into the server</a></h2><p class="css-1ftn47p">The correct place to put your .pem file is in your .ssh folder, in your user directory. The .ssh folder is a hidden folder, to open it in finder open terminal and execute the open command.</p><div><style data-emotion-css="1h0sj8d">.css-1h0sj8d{padding:16px;margin:0;margin-bottom:32px;font-size:85%;margin-top:32px;text-align:left;font-family:Inconsolata;border-radius:4px;}.css-1h0sj8d dark{[object Object];}.css-1h0sj8d light{[object Object];}</style><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token plain css-1baulvz"># The open command will open the</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># given path using the default system</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># application for the file type.</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ open ~/.ssh</span></div></pre></div><p class="css-1ftn47p">Once the .pem file is in your ssh folder, use chmod to set permissions so that it can be used as a key.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ chmod 400 ~/.ssh/whatever-your-key-name-is.pem</span></div></pre></div><p class="css-1ftn47p">To SSH we need to have a username, an address and a key. The address is available when we click on our instance in the EC2 instances dashboard.</p><p class="css-1ftn47p">To connect, the SSH command should look something like</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Fill in your specific details for this to work.</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ ssh -i ~/.ssh/whatever-your-key-name-is.pem ubuntu@your-public-DNS</span></div></pre></div><p class="css-1ftn47p">This will connect you to your instance, just type yes when prompted so that you can add your instance as a known host.</p><h2 id="install-nodejs"><a href="#install-nodejs" class="css-1r0pe6c">Install Node.js</a></h2><p class="css-1ftn47p">Once in an SSH session the first thing to do is get Node.js. NVM (Node Version Manager) is a pretty great way to install Node.js and allows you to easily switch versions if required.</p><p class="css-1ftn47p">To install NVM just run this command.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.1/install.sh | bash</span></div></pre></div><p class="css-1ftn47p">Then to get nvm working, run</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ source ~/.bashrc</span></div></pre></div><p class="css-1ftn47p">Find out the latest version of node. Then install by running</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ nvm install 7</span></div></pre></div><p class="css-1ftn47p">To check node is ready to go just echo the version.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ node --version</span></div></pre></div><h2 id="create-a-public-http-endpoint-that-responds-with-a-static-message"><a href="#create-a-public-http-endpoint-that-responds-with-a-static-message" class="css-1r0pe6c">Create a public HTTP endpoint that responds with a static message</a></h2><p class="css-1ftn47p">Now make a public URL anyone can request from the browser to get a response from the server.</p><ol class="css-cvh4i0"><li class="css-q43a5f">Make a directory for the server and cd into it.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ mkdir server</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ cd server</span></div></pre></div><ol start="2" class="css-cvh4i0"><li class="css-q43a5f">Now you are in your server directory, you need to npm init</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ npm init</span></div></pre></div><ol start="3" class="css-cvh4i0"><li class="css-q43a5f">Install express and add it to package.json.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ npm install express --save-dev</span></div></pre></div><ul class="css-cvh4i0"><li class="css-q43a5f">You should have a node_modules directory and package.json</li></ul><ol start="4" class="css-cvh4i0"><li class="css-q43a5f">Add some code to run the server</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ nano index.js</span></div></pre></div><div><pre class="language-javascript prism-code language-javascript css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token keyword css-1baulvz" style="color:#00009f">var</span><span class="token plain css-1baulvz"> express </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">require</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;express&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz" style="color:#00009f">var</span><span class="token plain css-1baulvz"> app </span><span class="token operator css-1baulvz" style="color:#393A34">=</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz" style="color:#d73a49">express</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">get</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">function</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token parameter css-1baulvz">req</span><span class="token parameter punctuation css-1baulvz" style="color:#393A34">,</span><span class="token parameter css-1baulvz"> res</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  res</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">send</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;Hello World!&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">listen</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token number css-1baulvz" style="color:#36acaa">3000</span><span class="token punctuation css-1baulvz" style="color:#393A34">,</span><span class="token plain css-1baulvz"> </span><span class="token keyword css-1baulvz" style="color:#00009f">function</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz" style="color:#393A34">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token console class-name css-1baulvz">console</span><span class="token punctuation css-1baulvz" style="color:#393A34">.</span><span class="token method function property-access css-1baulvz" style="color:#d73a49">log</span><span class="token punctuation css-1baulvz" style="color:#393A34">(</span><span class="token string css-1baulvz" style="color:#e3116c">&#x27;Example app listening on port 3000!&#x27;</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz" style="color:#393A34">}</span><span class="token punctuation css-1baulvz" style="color:#393A34">)</span><span class="token punctuation css-1baulvz" style="color:#393A34">;</span></div></pre></div><ol start="5" class="css-cvh4i0"><li class="css-q43a5f">Save and exit</li><li class="css-q43a5f">Open up port 3000 so we can test our server.</li></ol><ul class="css-cvh4i0"><li class="css-q43a5f">Leave your server running and go to the Security Groups tab in the EC2 console.</li><li class="css-q43a5f">Right click the security group you setup and click edit inbound rules.</li><li class="css-q43a5f">Click Add Rule. This time we are going to use a custom TCP rule on port 3000, open to anywhere.</li><li class="css-q43a5f">Click save</li></ul><ol start="7" class="css-cvh4i0"><li class="css-q43a5f">Visit your public DNS URL with port 3000 and you should see the Hello World! response.</li><li class="css-q43a5f">To leave the server running when we log out</li></ol><ul class="css-cvh4i0"><li class="css-q43a5f">Press ctrl+z to pause the process (this only works when your server is running, node index.js)</li><li class="css-q43a5f">You can see that the job number for node index.js is 1 (as noted by <!-- -->[1]<!-- -->+). To run that in the background, use the bg command.</li></ul><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ bg %1</span></div></pre></div><ul class="css-cvh4i0"><li class="css-q43a5f">Logout</li></ul><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">$ exit</span></div></pre></div><p class="css-1ftn47p">You should still be able to access your URL and see the “HEY!” response.</p><h2 id="serve-http-traffic-on-the-standard-port-80"><a href="#serve-http-traffic-on-the-standard-port-80" class="css-1r0pe6c">Serve HTTP traffic on the standard port, 80</a></h2><ol class="css-cvh4i0"><li class="css-q43a5f">SSH into the server if you are not.</li><li class="css-q43a5f">Run the command</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo apt-get install nginx</span></div></pre></div><p class="css-1ftn47p">apt-get runs nginx automatically after install so you should now have it running on port 80, check by entering your public DNS URL into a browser.</p><p class="css-1ftn47p">We need to configure nginx to route port 80 traffic to port 3000.</p><ol start="3" class="css-cvh4i0"><li class="css-q43a5f">Let’s first remove the default config from sites-enabled, we will leave it in sites-available for reference.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo rm /etc/nginx/sites-enabled/default</span></div></pre></div><ol start="4" class="css-cvh4i0"><li class="css-q43a5f">Create a config file in sites-available and name it whatever you like.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo nano /etc/nginx/sites-available/your-custom-name</span></div></pre></div><ol start="5" class="css-cvh4i0"><li class="css-q43a5f">The config to use</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">server {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  listen 80;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  server_name your-custom-name;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  location / {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    proxy_set_header  X-Real-IP  $remote_addr;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    proxy_set_header  Host       $http_host;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    proxy_pass        http://127.0.0.1:3000;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  }</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">}</span></div></pre></div><p class="css-1ftn47p">This will forward all HTTP traffic from port 80 to port 3000.</p><ol start="6" class="css-cvh4i0"><li class="css-q43a5f">Link the config file in sites enabled (this will make it seem like the file is actually copied insites-enabled).</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo ln -s /etc/nginx/sites-available/tutorial /etc/nginx/sites-enabled/tutorial</span></div></pre></div><ol start="7" class="css-cvh4i0"><li class="css-q43a5f">Restart nginx for the new config to take effect.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo service nginx restart</span></div></pre></div><ol start="8" class="css-cvh4i0"><li class="css-q43a5f">See if node application is running</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># list background jobs</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">jobs</span></div></pre></div><p class="css-1ftn47p">If your application shows up then no need to run it again. If it is not running then you need to start it.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">node tutorial/index.js</span></div></pre></div><p class="css-1ftn47p">Once the server is running, press ctrl+z, then resume it as a background task.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">bg %1</span></div></pre></div><p class="css-1ftn47p">Now visit your server’s public DNS URL, using port 80.</p><h2 id="keep-the-nodejs-process-running"><a href="#keep-the-nodejs-process-running" class="css-1r0pe6c">Keep the Node.js process running</a></h2><p class="css-1ftn47p">Before moving forward, stop your running node process</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Nukes all Node processes</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">killall -9 node</span></div></pre></div><p class="css-1ftn47p">To keep these processes running we are going to use a great NPM package called PM2. While in an SSH session, install PM2 globally.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm i -g pm2</span></div></pre></div><p class="css-1ftn47p">To start your server, simply use pm2 to execute index.js.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 start tutorial/index.js</span></div></pre></div><p class="css-1ftn47p">To make sure that your PM2 restarts when your server restarts</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 startup</span></div></pre></div><p class="css-1ftn47p">This will print out a line of code you need to run depending on the server you are using.
Run the code it outputs.
Finally, save the current running processes so they are run when PM2 restarts.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 save</span></div></pre></div><p class="css-1ftn47p">You can log out/in to SSH, even restart your server and it will continue to run on port 80.
To list all processes use</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 ls</span></div></pre></div><p class="css-1ftn47p">Your process will have a pretty generic name, something like index, which would be hard to differentiate if you had a few other microservices running on the server too. Let’s stop the process, remove it and start it back up with a better name.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Use the number listed in pm2 ls</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># to stop the daemon</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 stop index</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Remove it from the list</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 delete index</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Start it again, but give it a</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># catchy name</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 start your-custom-name/index.js --name “Your-Custom-Name”</span></div></pre></div><h2 id="deploy-code-into-the-server"><a href="#deploy-code-into-the-server" class="css-1r0pe6c">Deploy code into the server</a></h2><p class="css-1ftn47p">Instead of writing code in an SSH session, let’s push the code to a git repo in Github, SSH into the server and pull in the new code.</p><ol class="css-cvh4i0"><li class="css-q43a5f">Go to Github, login and create a new repository named what you like.</li><li class="css-q43a5f">Make a new directory wherever you like to put your code projects locally</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">mkdir your-new-Dir</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">cd your-new-Dir</span></div></pre></div><ol start="3" class="css-cvh4i0"><li class="css-q43a5f">Now set up your origin, make an empty commit and push it up, setting your upstream branch as master.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git init</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git commit --allow-empty -m &quot;my first commit, *yay*&quot;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Use your repo&#x27;s origin URL here</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git remote add origin git@github.com:WS/git-name-origin.git</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git push -u origin master</span></div></pre></div><ol start="4" class="css-cvh4i0"><li class="css-q43a5f">Run:</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm init</span></div></pre></div><ol start="5" class="css-cvh4i0"><li class="css-q43a5f">Create an index.js file</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">var express = require(&#x27;express&#x27;);</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">var app = express();</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app.get(&#x27;/&#x27;, function (req, res) {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  res.send(&#x27;Hello World!&#x27;);</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">});</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app.listen(3000, function () {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  console.log(&#x27;Example app listening on port 3000!&#x27;);</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">});</span></div></pre></div><ol start="6" class="css-cvh4i0"><li class="css-q43a5f">NPM install express</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm install express --save</span></div></pre></div><p class="css-1ftn47p">Add a .gitignore file so that we don’t check in the node_modules directory. .DS_Store files always get added to directories by OSX, they contain folder meta data. We want to ignore these too.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">node_modules</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">.DS_Store</span></div></pre></div><p class="css-1ftn47p">Now add all your code and push it up</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git add .</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git commit -m &quot;Ze server.&quot;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git push</span></div></pre></div><p class="css-1ftn47p">Now we need to pull the code into the server.
We need to SSH into the server, generate a SSH private/public key pair and then add it as a deployment key in source control (i.e. Github). Only when the server is allowed access to the remote repo will it be able to clone the code and pull down changes.
7. SSH into your server and generate the key pair.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># When prompted, use the default name.</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># No need for a pass phrase.</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">ssh-keygen -t rsa</span></div></pre></div><ol start="8" class="css-cvh4i0"><li class="css-q43a5f">Show the contents of the file</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">cat ~/.ssh/id_rsa.pub</span></div></pre></div><p class="css-1ftn47p">Select the key’s contents and copy it into Github. Deploy keys are added in a section called Deploy keys in the settings for your repo.</p><ol start="9" class="css-cvh4i0"><li class="css-q43a5f">Paste your key and call it something meaningful.
Whenever you are logged in over SSH, you want the keys to be added so that they are used to authenticate with Github. To do this, add these lines to the top of your ~/.bashrc file.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Start the SSH agent</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">eval `ssh-agent -s`</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Add the SSH key</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">ssh-add</span></div></pre></div><p class="css-1ftn47p">This will make sure you use the keys whenever you log on to the server.
10. To run the code without logging out, execute the .bashrc file</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">source ~/.bashrc</span></div></pre></div><ol start="11" class="css-cvh4i0"><li class="css-q43a5f">Now we can clone the repo! Remove any previous code on the server and in the user directory, clone the repo</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># You should use your own git URL.</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git clone git@github.com:WS/git-name-origin.git</span></div></pre></div><p class="css-1ftn47p">We want to completely avoid ever using SSH. For deployment, we are going to use PM2 in order for us to do the git cloning on the server.
12. Before using PM2, remove the code you just pulled in from git into your server.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">rm -rf ~/tutorial-pt-2</span></div></pre></div><ol start="13" class="css-cvh4i0"><li class="css-q43a5f">While you are still in the SSH session, ensure that there are no processes still running on PM2, if there are then remove them.</li></ol><div><pre class="language-pm2 prism-code language-pm2 css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># Only do this if a task is still running</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 delete your-custome-name</span></div></pre></div><ol start="14" class="css-cvh4i0"><li class="css-q43a5f">In your local version of the project, install PM2 globally</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm i -g pm2</span></div></pre></div><p class="css-1ftn47p">Now we need to add a config file PM2 can read so that it knows how to deploy.</p><ol start="15" class="css-cvh4i0"><li class="css-q43a5f">The config file should be named ecosystem.config.js and should look like this</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">module.exports = {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  apps: [{</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    name: &#x27;your-custom-name&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    script: &#x27;./index.js&#x27;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  }],</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  deploy: {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    production: {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      user: &#x27;ubuntu&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      host: &#x27;your-aws-public-dns&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      key: &#x27;~/.ssh/your-key.pem&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      ref: &#x27;origin/master&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      repo: &#x27;git@github.com:ws/your-custom-name.git&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      path: &#x27;/home/ubuntu/your-custom-name&#x27;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">      &#x27;post-deploy&#x27;: &#x27;npm install &amp;&amp; pm2 startOrRestart ecosystem.config.js&#x27;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    }</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  }</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">}</span></div></pre></div><ol start="16" class="css-cvh4i0"><li class="css-q43a5f">Once the file is saved, setup the directories on the remote</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 deploy ecosystem.config.js production setup</span></div></pre></div><ol start="17" class="css-cvh4i0"><li class="css-q43a5f">Once setup, commit and push your changes to Github so that when it clones it gets your ecosystem.config.js file, which is going to be used to start your app using PM2 on the server.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git add .</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git commit -m &quot;Setup PM2&quot;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">git push</span></div></pre></div><ol start="18" class="css-cvh4i0"><li class="css-q43a5f">Now you can run the deploy command</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 deploy ecosystem.config.js production</span></div></pre></div><p class="css-1ftn47p">This should come up with an error, which will be that npm was not found.
19. SSH into your server and open up the ~/.bashrc file. The code that excludes non-interactive sessions is near the top.</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"># If not running interactively, don&#x27;t do anything</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">case $- in</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  *i*) ;;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  *) return;;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">esac</span></div></pre></div><ol start="20" class="css-cvh4i0"><li class="css-q43a5f">Move the NVM code above this code, so it always executes. Find the following lines and move them above the case statement</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">export NVM_DIR=&quot;/home/ubuntu/.nvm&quot;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; . &quot;$NVM_DIR/nvm.sh&quot;  # This loads nvm</span></div></pre></div><ol start="21" class="css-cvh4i0"><li class="css-q43a5f">Save and exit.</li><li class="css-q43a5f">Back on your local terminal, try running the PM2 deploy again</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 deploy ecosystem.config.js production</span></div></pre></div><p class="css-1ftn47p">It should work this time! And your server should still be running when you check in a browser.
Using a global PM2 on the server and a global PM2 on the client is a bit messy. It would be better if our code used the local version of the PM2 package. To do this, add a deploy and restart script to your package.json</p><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">...</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  &quot;main&quot;: &quot;index.js&quot;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  &quot;scripts&quot;: {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    &quot;restart&quot;: &quot;pm2 startOrRestart ecosystem.config.js&quot;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    &quot;deploy&quot;: &quot;pm2 deploy ecosystem.config.js production&quot;,</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  },</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  &quot;repository&quot;: {</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">...</span></div></pre></div><ol start="23" class="css-cvh4i0"><li class="css-q43a5f">Install PM2 locally and save, using --save-dev</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm i pm2 --save-dev</span></div></pre></div><ol start="24" class="css-cvh4i0"><li class="css-q43a5f">Before deploying, commit all your changes and push to git.</li><li class="css-q43a5f">When you run npm deploy, it will now use the local version of PM2.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm run-script deploy</span></div></pre></div><ol start="26" class="css-cvh4i0"><li class="css-q43a5f">Make sure the app restarts when the server restarts, SSH back into your server and run</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 save</span></div></pre></div><p class="css-1ftn47p">The only PM2 process running should be your deployed server, so PM2 will ensure that is always kept running.</p><h2 id="serve-some-html"><a href="#serve-some-html" class="css-1r0pe6c">Serve some HTML</a></h2><ol class="css-cvh4i0"><li class="css-q43a5f">Remove the route handler for / and set up a static directory that express will use to serve static files.</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">var express = require(&#x27;express&#x27;)</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">var app = express()</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app.use(express.static(&#x27;public&#x27;))</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">app.listen(3000, () =&gt; console.log(&#x27;Server running on port 3000&#x27;))</span></div></pre></div><p class="css-1ftn47p">By calling express.static with “public”, static files will be served from the public directory. If we add an index.html in /public, then this will be automatically served at / by express (if we left a custom / handler, then that would override this functionality).
2. Save a HTML file in public/index.html</p><div><pre class="language-html prism-code language-html css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token doctype css-1baulvz" style="color:#999988;font-style:italic">&lt;!DOCTYPE html&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">html</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">head</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">title</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz">Erm hey.</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">title</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">head</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">body</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">    </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;</span><span class="token tag css-1baulvz" style="color:#00009f">p</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz">Something</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">p</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">  </span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">body</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span><span class="token plain css-1baulvz"></span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz"></span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&lt;/</span><span class="token tag css-1baulvz" style="color:#00009f">html</span><span class="token tag punctuation css-1baulvz" style="color:#393A34">&gt;</span></div></pre></div><ol start="3" class="css-cvh4i0"><li class="css-q43a5f">Commit these changes (perhaps you could check the server still works by running node index.js locally and visiting <style data-emotion-css="1iv9jyz">.css-1iv9jyz{color:var(--theme-ui-colors-primary,#0B5FFF);-webkit-text-decoration:none;text-decoration:none;}.css-1iv9jyz:hover{color:secondary;-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="http://localhost:3000" class="css-1iv9jyz">http://localhost:3000</a>).</li><li class="css-q43a5f">Deploy the changes</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">npm run-script deploy</span></div></pre></div><p class="css-1ftn47p">Your server will now respond with your static HTML page.</p><h2 id="install-node-red-on-aws-ec2-instance"><a href="#install-node-red-on-aws-ec2-instance" class="css-1r0pe6c">Install Node-Red on AWS EC2 instance</a></h2><ol class="css-cvh4i0"><li class="css-q43a5f">From AWS EC2 console got to ‘Configure Security Group’ tab, add a new ‘Custom TCP Rule’ for port 1880 and save.</li><li class="css-q43a5f">SSH into your server from terminal</li><li class="css-q43a5f">Run</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">sudo npm install -g node-red</span></div></pre></div><ol start="4" class="css-cvh4i0"><li class="css-q43a5f">Test your instance by running</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">node-red</span></div></pre></div><ol start="5" class="css-cvh4i0"><li class="css-q43a5f">Once started, you can access the editor at <a href="http://%7Byour-instance-ip%7D:1880/" class="css-1iv9jyz">http://{your-instance-ip}:1880/</a>.</li><li class="css-q43a5f">To get Node-RED to start automatically whenever your instance is restarted, you can use pm2:</li></ol><div><pre class=" prism-code language-text css-1h0sj8d" style="font-family:Inconsolata;color:#393A34;background-color:#f6f8fa;overflow-x:auto" data-testid="code"><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 start `which node-red` -- -v</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 save</span></div><div class="token-line" style="font-family:Inconsolata;color:#393A34"><span class="token plain css-1baulvz">pm2 startup</span></div></pre></div></div></div></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/docs/aws-ec2-node-red/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-7c842360d978e7d2baa8.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-0dbb9bf55df3a03c51e7.js"],"component---readme-md":["/component---readme-md-95098cf17ae468512826.js"],"component---docs-index-mdx":["/component---docs-index-mdx-a00960dd7b17ba786196.js"],"component---blog-hello-world-index-md":["/component---blog-hello-world-index-md-4ef8547df69edac3b8d5.js"],"component---blog-hi-folks-index-md":["/component---blog-hi-folks-index-md-f02818ccc9f17ce80df8.js"],"component---blog-my-second-post-index-md":["/component---blog-my-second-post-index-md-6e6076ce89806c067ca7.js"],"component---docs-awsnode-mdx":["/component---docs-awsnode-mdx-4e4b372ff7210d200ba0.js"]};/*]]>*/</script><script src="/component---docs-awsnode-mdx-4e4b372ff7210d200ba0.js" async=""></script><script src="/commons-99e66c7da493e5e14858.js" async=""></script><script src="/app-7c842360d978e7d2baa8.js" async=""></script><script src="/styles-e213a0d857960fd55403.js" async=""></script><script src="/webpack-runtime-22f56f90e70b3c67d9aa.js" async=""></script></body></html>